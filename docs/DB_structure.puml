@startuml ArucoService

!function $autogenerated($a)
!return "<color:RoyalBlue>" + $a + " <<autogenerated PK>></color>"
!endfunction

!function $unique($a)
!return "<color:Crimson>" + $a + " <<unique>></color>"
!endfunction

!function $setBold($a)
!return "<b>" + $a + " </b>"
!endfunction

skinparam LegendBackgroundColor MistyRose
skinparam LegendBorderColor PaleVioletRed
skinparam LegendFontColor PaleVioletRed

skinparam Class {
    HeaderBackgroundColor PaleGreen
}

'skinparam linetype ortho
skinparam TitleFontColor Sienna

Title ER-диаграмма "Aruco marks Service"
left to right direction
entity "$setBold("users")" as users {
    * $autogenerated("id : uuid")
    ..
    * access_level : uuid <<access.id FK>>
    * login : varchar(100)
    * $unique("password <<hashed>>") : varchar(64)
}

entity "$setBold("access")" as access {
    * $autogenerated("id : uuid")
    ..
    name : varchar(100)
}

entity "$setBold("access_to_privileges")" as access_to_privileges {
    * access_id : uuid <<access.id FK>>
    * privilege_id : uuid <<privilege.id FK>>
}

entity "$setBold("privilege")" as privilege {
    * $autogenerated("id : uuid")
    ..
    * name : varchar(100)
}

entity "$setBold("user_actions")" as user_actions {
    * $autogenerated("id : uuid")
    ..
    * name : varchar(100)
    * user_id : uuid <<users.id FK>>
    * time : timestamp
}

entity "$setBold("marks")" as marks {
    * $autogenerated("id : uuid")
    ..
    * mark_id : uint
    * mark_type : uuid <<mark_types.id FK>>
}

entity "$setBold("mark_types")" as mark_types {
    * $autogenerated("id : uuid")
    ..
    * name : varchar(100)
    family : varchar(100)
}

entity "$setBold("locations")" as locations {
    * $autogenerated("id : uuid")
    ..
    name : varchar(100)
    * min_pos : float[3]
    * max_pos : float[3]
}



entity "$setBold("objects")" as objects {
    * $autogenerated("id : uuid")
    ..
    name : varchar(100)
    size : float[3]
    * location_id : uuid <<locations.id FK>>
    * last_position : float[3]
    * last_update_time : timestamp
}

entity "$setBold("marks_on_objects")" as marks_on_objects {
    * mark_id : uuid <<marks.id FK>>
    * object_id : uuid <<objects.id FK>>
    * relative_pos : float[3]
}

users::access_level -> access::id
marks::mark_type -> mark_types::id
objects::location_id -> locations::id
user_actions::user_id -> users::id
marks_on_objects::mark_id -> marks::id
marks_on_objects::object_id -> objects::id
access_to_privileges::privilege_id -> privilege::id
access_to_privileges::access_id -> access::id

legend right
$setBold("Условные обозначения:")
* - обязательное поле
PK - первичный ключ
FK - внешний ключ
end legend

footer Buchkin Timur, 2024

@enduml
